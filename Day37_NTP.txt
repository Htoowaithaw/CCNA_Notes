# **Day 37 | NTP | CCNA 200-301 Complete Course**

**Day 37 â€“ NTP (Network Time Protocol)**

---

### ğŸ§’ Kid-Level Summary (Explain Like I'm 5)

Imagine you and your friends all have watches. If one friendâ€™s watch says itâ€™s 3 PM and another says 5 PM, you might get confused when you try to play a game at the same time. To fix that, everyone checks the school bell to know the real time and sets their watches to match.

**NTP is like that school bell**â€”it helps routers and switches match their clocks, so they donâ€™t get confused when they talk to each other. When every device knows the right time, they can write good notes (logs) about what happened and when.

You can also:

- Set the time by hand (manual clock setting), like adjusting a watch.
- Use a trusted time server (NTP Server), like a school bell.
- Share that time with other friends (act as a server or peer).
- Protect your time sync with a password (NTP authentication).

---

### ğŸ§  Technical Explanation

### ğŸ“Œ Why Time Matters

- **Accurate timestamps** are crucial for logging events like interface failures, OSPF neighbor changes, and troubleshooting.
- Devices have **internal clocks** (software clock) and **hardware clocks** (calendar). Both can drift over time.

### â± Manual Time Configuration

- `clock set` â€“ Set software clock manually (time, date).
- `calendar set` â€“ Set hardware clock manually.
- `clock update-calendar` â€“ Sync calendar from software clock.
- `clock read-calendar` â€“ Sync software clock from calendar.
- `clock timezone JST 9` â€“ Set timezone to JST (Japan Standard Time).
- `clock summer-time EDT recurring 2 Sunday March 2:00 1 Sunday November 2:00` â€“ Configure daylight saving.

### ğŸŒ NTP Basics

- **NTP = Network Time Protocol**. Uses UDP port 123.
- NTP clients request time from NTP servers and synchronize their software clocks.
- Public servers include `time.google.com`, `time.windows.com`.
- Use `ntp server <IP>` to sync time.
- Can have multiple servers for redundancy; add `prefer` for priority.
- Time hierarchy:
    - Stratum 0: Atomic/GPS clock (not directly reachable)
    - Stratum 1: Directly connected to stratum 0 (primary)
    - Stratum 2+: Sync from higher stratum (secondary)

### ğŸ” Useful Show Commands

- `show clock detail` â€“ View software clock & source
- `show calendar` â€“ View hardware clock
- `show ntp associations` â€“ Shows all servers, which one is selected (`= sys.peer`)
- `show ntp status` â€“ Shows if the clock is synchronized and current stratum

### ğŸ›  NTP Configuration Commands

- `ntp server <IP>` â€“ Sets the device as NTP client
- `ntp source <interface>` â€“ Sets source IP (commonly a loopback)
- `ntp update-calendar` â€“ Updates hardware clock with NTP time
- `ntp master [stratum]` â€“ Manually sets router as NTP server (default stratum 8)
- `ntp peer <IP>` â€“ Enables symmetric active mode with a peer

### ğŸ”’ NTP Authentication (Optional)

- `ntp authenticate` â€“ Enable authentication
- `ntp authentication-key <#> md5 <password>` â€“ Define key
- `ntp trusted-key <#>` â€“ Mark key as trusted
- `ntp server <IP> key <#>` â€“ Apply key to client-server relationship
- `ntp peer <IP> key <#>` â€“ Apply key to peer relationship

---

### ğŸ“Œ Quiz Review (from Jeremy & Boson)

- **`clock read-calendar`** â€“ Sync software clock to hardware clock
- **`clock timezone JST 9`** â€“ Configure timezone
- **`ntp master 9`** â€“ Sets device as stratum 9 NTP master
- **`ntp server <IP>`** â€“ Enables client mode
- Authentication: Need `authenticate`, `authentication-key`, `trusted-key`, and `server ... key <#>`